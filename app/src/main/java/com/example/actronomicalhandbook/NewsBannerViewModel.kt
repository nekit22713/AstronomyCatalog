package com.example.actronomicalhandbook

import androidx.compose.runtime.mutableStateListOf
import androidx.lifecycle.ViewModel
import kotlin.random.Random

data class NewsItem(
    val id: Int,
    val summary: String,
    val description: String,
    var likeCount: Int = 0,
)

class NewsBannerViewModel : ViewModel() {
    private val _newsList = mutableStateListOf(
        NewsItem(1, "Илон Маск объявил о запуске миссии на Марс в 2026 году", "SpaceX планирует запустить первую пилотируемую миссию на Марс уже в 2026 году. Маск обещает колонизировать Красную планету в ближайшие десятилетия."),
        NewsItem(2, "Роскосмос завершил испытания первого российского лунного модуля", "Роскосмос объявил об успешных испытаниях первого лунного посадочного модуля, который должен отправиться на Луну в 2025 году в рамках российской лунной программы."),
        NewsItem(3, "NASA отправляет телескоп нового поколения к Юпитеру", "NASA анонсировало запуск телескопа нового поколения, который позволит детально изучить атмосферу и магнетосферу Юпитера. Ожидается, что телескоп откроет новые тайны газового гиганта."),
        NewsItem(4, "Илон Маск представил проект космического отеля на орбите Земли", "SpaceX совместно с крупными инвесторами планирует построить первый в мире космический отель на низкой околоземной орбите. Гостям обещают виды на Землю и полный комфорт в условиях невесомости."),
        NewsItem(5, "NASA и Роскосмос договорились о совместной миссии на Венеру", "Впервые за последние 30 лет NASA и Роскосмос решили объединить усилия для исследования Венеры. Ожидается, что миссия стартует в 2028 году и изучит атмосферу планеты."),
        NewsItem(6, "SpaceX запускает сеть спутников для наблюдения за климатом", "В рамках проекта Starlink Илон Маск объявил о запуске новой серии спутников, которые будут собирать данные о климатических изменениях на Земле и помогать в прогнозировании природных катастроф."),
        NewsItem(7, "Роскосмос испытал новый двигатель для межпланетных миссий", "Роскосмос успешно протестировал революционный ионный двигатель, который может использоваться для долгосрочных межпланетных миссий, в том числе для полетов к Марсу и Юпитеру."),
        NewsItem(8, "NASA начинает подготовку миссии для возвращения образцов с Марса", "В рамках программы Mars Sample Return NASA разрабатывает план по доставке на Землю образцов марсианского грунта, собранных ровером Perseverance. Миссия запланирована на 2030 год."),
        NewsItem(9, "Илон Маск заявил о намерении построить город на Луне к 2035 году", "Маск объявил о долгосрочных планах SpaceX по созданию постоянной лунной базы, которая со временем превратится в полноценный город на Луне с тысячами жителей."),
        NewsItem(10, "Роскосмос и NASA обсудили возможность создания совместной орбитальной станции", "На конференции в Москве представители Роскосмоса и NASA обсудили перспективы создания новой международной космической станции, которая заменит МКС после её вывода из эксплуатации в 2031 году.")
    )

    val displayedNews = mutableStateListOf<NewsItem>().apply {
        addAll(_newsList.shuffled().take(4))
    }

    fun likeNewsCb(newsItem: NewsItem) {
        val index = displayedNews.indexOf(newsItem)
        if (index != -1) {
            displayedNews[index] = newsItem.copy(likeCount = newsItem.likeCount+1)
            newsItem.likeCount++
        }
    }

    fun reorderNews() {
        val randomIndex = Random.nextInt(0, displayedNews.size)
        var randomNews: NewsItem
        do {
            randomNews = _newsList[Random.nextInt(0, _newsList.size)]
        } while (randomNews in displayedNews)
        displayedNews[randomIndex] = randomNews
    }
}
